angular.module("app.issues.controllers",["ngRoute"]),angular.module("app.issues.controllers").controller("issuesCtrl",["$scope","$location","issuesService","$element",function(e,s,r,o){e.showloading=!0,r.getIssues.then(function(s){e.attachment=[],s.forEach(function(e,s){r.getIssue(e.id).then(function(s){"object"==typeof s.fields.attachment[0]?e.attachment=s.fields.attachment[0].content:e.attachment="http://placehold.it/900x300"})}),e.showloading=!1,e.issues=s})}]),angular.module("app.issues.controllers").controller("issueCtrl",["$scope","$element","$location","issuesService",function(e,s,r,o){function t(s){e.showloading=!0,o.getIssue($key).then(function(r){var o=r.fields,t=o.customfield_10201,a=$.Deferred(),i=$.Deferred(),l=null===o.customfield_10205?"not-started":o.customfield_10205.value,u=null===o.customfield_10206?"not-started":o.customfield_10206.value,c="done"===u?100:50,p="done"===l?100:50,d=0;if(null==t)console.log("no scenes");else{var g=t.split(","),f={},h=0,_=i.pipe(function(e,s){var r=100*e,o=s/r,t=100*o;return NaN==t?0:Math.round(t)});for(scene in g){var v=g[scene].split(":"),m=v[0],b=v[1];h+=parseInt(b),f[m]=b}i.resolve(Object.keys(f).length,h),_.done(function(s){e.total=s,s<25&&(e.scene_progress=n[0]),s>=25&&s<=50&&(e.scene_progress=n[1]),s>=50&&s<=75&&(e.scene_progress=n[2]),s>=75&&s<=99&&(e.scene_progress=n[3]),100==s&&(e.scene_progress=n[4])})}null==u?console.log("no docs"):"not-started"==u?e.doc_progress=n[5]:"in-progress"==u?e.doc_progress=n[1]:"done"==u&&(e.doc_progress=n[6]),null==l?console.log("no drawing"):"not-started"==l?e.drawing_progress=n[5]:"in-progress"==l?e.drawing_progress=n[1]:"done"==l&&(e.drawing_progress=n[6]),e.summary=o.summary,e.description=o.description,e.attachment=o.attachment[0].content,e.doc=u,e.drawing=l,e.doc_value=c,e.drawing_value=p,d=e.doc_value+e.drawing_value+e.total;var w=a.pipe(function(e){var s=e,r=s/300,o=100*r;return NaN==o?0:Math.round(o)});a.resolve(d),e.updated="updated: "+moment(o.updated).fromNow(),w.done(function(s){e.total_progress=s,s<25&&(e.total_progressbar=n[0]),s>=25&&s<=50&&(e.total_progressbar=n[1]),s>=50&&s<=75&&(e.total_progressbar=n[2]),s>=75&&s<=99&&(e.total_progressbar=n[3]),100==s&&(e.total_progressbar=n[4])}),s&&(e.showloading=!1)})}$key=s.find("#issue-key").val(),e.total=0,e.scene_progress="",e.scene_total=0,e.doc="",e.doc_progress="",e.doc_value=0,e.drawing="",e.drawing_value=0,e.total_progress=0,e.total_progressbar="",e.showloading=!0,e.showcontent=!1;var n=["progress-bar-danger progress-bar-striped","progress-bar-warning progress-bar-striped active","progress-bar-info progress-bar-striped active","progress-bar-success progress-bar-striped active","progress-bar-success","progress-bar-danger progress-bar-striped active","progress-bar-success progress-bar"];t(!0),setInterval(function(){t()},3e5)}]),angular.module("app.issues.directives",["ngRoute"]),angular.module("app.issues.services",[]),angular.module("app.issues.services").service("issuesService",["$http",function(e){this.getIssues=e({method:"GET",url:"/jira/issues",headers:{"Content-type":"application/json"}}).then(function(e){return e.data.issues},function(e){throw new Error(e.responseText)}),this.getIssue=function(s){return e({method:"GET",url:"/jira/issue/"+s,headers:{"Content-type":"application/json"}}).then(function(e){return e.data},function(e){throw new Error(e.responseText)})}}]),angular.module("jiraApp",["app.issues.services","app.issues.controllers","ngRoute"]);